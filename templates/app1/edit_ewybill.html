{% extends 'app1/base.html' %}
{% block body %}
{% load static %}
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<style>
     @import url(https://fonts.googleapis.com/css?family=Open+Sans);

body{
background: #f2f2f2;
font-family: 'Open Sans', sans-serif;
}

.search {
width: 100%;
position: relative;
display: flex;
}

.searchTerm {
width: 100%;
border: 3px solid #7690da;
border-right: none;
padding: 5px;
height: 36px;
border-radius: 5px 0 0 5px;
outline: none;
color: #9DBFAF;

}

.searchTerm:focus{
color:#7690da;
}

.searchButton {
width: 40px;
height: 36px;
border: 1px solid #7690da;
background:#7690da;
text-align: center;
color: #fff;
border-radius: 0 5px 5px 0;
cursor: pointer;
font-size: 20px;
}

.table-row{
        cursor:pointer;
}
/* .table-row:hover{
    background-color: rgb(217, 232, 51);
} */

/*Resize the wrap to see the search bar change!*/
.wrap{
width: 40%;
/* position: absolute;
top: 50%;
left: 50%; */
/* transform: translate(-50%, -50%); */
}
</style>
    <div class="page-content">
        <div class="card radius-15">
            <div class="card-body">
                <div class="card-title">
                    <center><h3 class="mb-0"> E-WAY BILL NO:{{estimate.ewayinvid}}</h3></center>
                </div>
                <hr/>
            </div>
        </div>
        <div class="card radius-15" style="background-color: #243e54;">
            <div class="card-body">
                <!--<div class="card-title">
                    <h4 class="mb-0">PART A</h4>
                </div>
                <hr/>-->
                <form action="{% url 'updateewaybill2' estimate.ewayinvid %}" method="post" class="needs-validation" enctype="multipart/form-data"  novalidate autocomplete="off">
                    {% csrf_token %}
                    {% if user.is_authenticated %}

                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="validationCustom01">Document Type</label>
                            <select name="d_type" id="titlesss" class="form-control">
                                <option value="{{estimate.doc_type}}">{{estimate.doc_type}}</option>
                                <option value="Invoices">Invoices</option>
                                <option value="Credit Notes">Credit Notes</option>
                                <option value="Delivery Challans">Delivery Challans</option>
                                </select>
                        </div>
                       
                    </div>
                        <div class="row">
                            <div class="col-md-4 mt-3">
                                <label for="validationCustom01">Transaction Sub Type </label>
                                <select name="s_type" id="titlew" class="form-control">
                                    <option value="{{estimate.transaction_stype}}">{{estimate.transaction_stype}}</option>
                               
                                    <option value="Supply">Supply</option>
                                    <option value="Import">Import</option>
                                    <option value="Export">Export</option>
                                    <option value="Job Work">Job Work</option>
                                    <option value="For Own Use">For Own Use</option>
                                    <option value="Job Work Returns">Job Work Returns</option>
                                    <option value="Sales Returns">Sales Returns </option>
                                    <option value="Others">Others</option>
                                    <option value="SKD/CKD">SKD/CKD</option>
                                    <option value="Line Sales">Line Sales</option>
                                    <option value="Recipient Not Known">Recipient Not Known</option>
                                    <option value="Exhibition or Faris">Exhibition or Faris</option>
                                </select>
                            </div>
                           
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4 mt-3 ">
                                <label for="validationCustom03">Customer Name</label>
                                <div class="d-flex">
                                <select name="transporter" id="customer" class="form-control">
                                   

                                    <option value="{{ cust1.title }} {{ cust1.firstname }} {{ cust1.lastname }}">{{ cust1.title }} {{ cust1.firstname }} {{ cust1.lastname }}</option>
                                    {% for cust in customers %}
                                    {% if cust.cid_id == cmp1.cid %}
                                    <option  value="{{ cust.customerid }} {{ cust.firstname }} {{ cust.lastname }}">{{ cust.title }} {{ cust.firstname }} {{ cust.lastname }}</option>
                                     {% endif %}
                                {% endfor %}

                                </select>
                                <a data-toggle="modal" href="#customercreation">
                                    <button type="button" class="btn btn-outline-secondary ml-1">+</button>
                                </a></div></div>
                                <div class="col-md-3 mt-3">
                                <label >Email</label>
                                <input type="text" class="form-control" id="est_email" name="email" value="{{estimate.email}}"></div>
                                <div class="col-md-3 mt-3">
                                <label >GSTIN</label>
                                <input type="text" class="form-control" id="e_gstin" name="gstin" value="{{estimate.gstin}}"></div>
                            
                        </div>
                           
                        
                        <div class="row">
                            <div class="col-md-4 mt-3">
                                <label for="validationCustom03">Invoice

                                </label>
                                <input type="text" class="form-control" placeholder="INV-0000" id="validationCustom03" name="invc" value="{{estimate.invoice}}"
                                    >
                            </div>
                            <div class="col-md-3 mt-3">
                                <label for="col-form-label">Date

                                </label>
                                <input type="date"  class="form-control" value="{{ estimate.datese|date:'d-m-Y' }}" name="dat"  >
                            </div>
                            <div class="col-md-3 mt-3">
                                <label for="validationCustom03">Transaction Type

                                </label>
                                <select name="t_type" id="titleh" class="form-control">
                                    <option value="{{estimate.transaction_type}}">Select  </option>
                                    <option value="goods">Goods</option>
                                   </select>
                            </div>
                        </div>
                      
                        <hr>
                        <h4></h4>

                        <div class="row">
                            <div class="col-md-4 mt-3">
                                <label class="text-gray-light">Address Details</label>
                                <textarea class="form-control mb-4" name="bname" id="bname" rows="7" type="text" style=" color: white;" value="{{estimate.address}}">{{estimate.address}}</textarea>
                          
                            </div>
                           
                        </div>
                       
                        <div class="row">
                            <div class="col-md-4 mt-3">
                                <label for="validationCustom01">Place of Suply</label>
                                <select name="tmode" id="plosu" class="form-control">
                                    <option value="{{ cmp1.state }}" selected> {{ cmp1.state }}</option>
                                    <option value="[AN]-Andaman And Nicobar Islands">[AN]-Andaman And Nicobar Islands</option> <option value="[AD]-Andhra Pradesh">[AD]-Andhra Pradesh</option>
                      <option value="[AR]-Arunachal Pradesh">[AR]-Arunachal Pradesh	</option> <option value="volvo">[AS]-Assam</option>
                      <option value="[BR]-Bihar">[BR]-Bihar</option> <option value="volvo">[CH]-	Chandhigarh</option><option value="[CG]-Chattisgarh">[CG]-Chattisgarh</option>
                      <option value="[DD]-Daman Diu">[DD]-Daman Diu</option><option value="volvo">[DL]-	Delhi</option><option value="[GA]-Goa">[GA]-Goa</option> <option value="[GJ]-Gujarat">[GJ]-Gujarat</option>
                      <option value="[HR]-Haryana">[HR]-Haryana</option> <option value="[HP]-Himachal Pradesh">[HP]-Himachal Pradesh</option>
                      <option value="[JK]-Jammu And Kashmir">[JK]-Jammu And Kashmir</option><option value="[JH]-Jharkand">[JH]-Jharkand</option>
                      <option value="[KA]-Karnataka">[KA]-Karnataka</option><option value="[KL]-Kerala">[KL]-Kerala</option>
                      <option value="[LA]-Ladakh">[LA]-Ladakh</option><option value="[LD]-Lakshadweep">[LD]-Lakshadweep</option>
                      <option value="[MP]-Madhyapradesh">[MP]-Madhyapradesh</option><option value="[MH]-Maharashtra">[MH]-Maharashtra</option>
                      <option value="[MN]-Manipur">[MN]-Manipur</option>  <option value="[ML]-Meghalaya">[ML]-Meghalaya</option>
                    <option value="[MZ]-Mizoram">[MZ]-Mizoram</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option> <option value="[NL]-Nagaland">[NL]-Nagaland</option>
                     <option value="[OD]-Odisha">[OD]-Odisha</option><option value="[PY]-Puducherry">[PY]-Puducherry</option>
                      <option value="[PB]-Punjab">[PB]-Punjab.</option><option value="[RL]-Rajasthan">[RL]-Rajasthan</option>
                      <option value="[SK]-Sikkim">[SK]-Sikkim</option><option value="[TN]-Tamilnadu">[TN]-Tamilnadu</option>
                      <option value="[TS]-Telenghana">[TS]-Telenghana</option><option value="[TR]-Tripura">[TR]-Tripura</option><option value="[UP]-Uttar Pradesh">[UP]-Uttar Pradesh</option>
                      <option value="[UK]-Utharakhand">[UK]-Utharakhand</option><option value="[WB]-West Bengal">[WB]-West Bengal</option>
                      <option value="[OT]-Other Territory">[OT]-Other Territory</option>
                                </select>
                            </div>
                            <div class="col-md-3 mt-3">
                                <label for="validationCustom03">Delivery Date </label>
                                <input type="date" class="form-control"  name="ddate" value="{{ estimate.delivry_date | date:'d-m-Y' }}"
                                    >
  
                            </div>
                            <div class="col-md-3 mt-3">
                                <label for="validationCustom03">Distance (Km)</label>
                                <input type="text" class="form-control" id="validationCustom03" name="km" value="{{estimate.distance}}">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mt-3">
                                <label for="validationCustom01">Mode of Transportation</label>
                                <div class="d-flex">
                                <select name="mode" id="titleoo" class="form-control">
                                    <option value="{{estimate.transport_mode}}">{{estimate.transport_mode}}</option>
                                    <option value="Road">Road</option>
                                    <option value="Rail">Rail</option>
                                    <option value="Ship">Ship</option>
                                    <option value="Air">Air</option>
                                    <option value="Air">Bus</option>
                                </select>
                                <a href="#">
                                    <button type="button" class="btn btn-outline-secondary ml-1" 
                                    data-target="#newtransporter" data-toggle="modal">+</button>
                                </a>
                            </div>
                           
                        </div>
                        <div class="col-md-3 mt-3">
                            <label for="validationCustom03">Vehicle Type</label>
                            <select name="vhtype" id="uu" class="form-control">
                                <option value="{{estimate.vehicle_type}}">{{estimate.vehicle_type}}</option>
                                <option value="car">Car</option>
                                <option value="bus">Bus</option>
                                <option value="train">Train</option>
                                <option value="Plane">Plane</option>
                                <option value="ship">Ship</option><option value="Air">Bus</option>
                            </select>
                        </div>
                        <div class="col-md-3 mt-3">
                            <label for="validationCustom03">Vehicle No</label>
                            <input type="text" class="form-control" id="validationCustom03" name="vno"
                               value="{{estimate.vehicle_no}}" >
                        </div></div>
                       
                       
                <hr>
                <h4>Items Details</h4>
                <hr>

                
                <div class="row clearfix">
                    <div class="col-md-12 table-responsive-md mt-3">
                        <table class="table table-bordered table-hover mt-3" id="tab_logic">
                            <thead>
                            <tr>
                                <th class="text-center">#</th>
                                <th class="text-center" >ITEMS</th>
                                <th class="text-center">HSN</th>
                                <th class="text-center">QTY</th>
                                <th class="text-center">PRICE</th>
                                <th class="text-center">TAX (%)</th>
                                <th class="text-center">DISCOUNT</th>
                                <th class="text-center">TOTAL</th>
                            </tr>
                            </thead>
                            <tbody id="items-table-body">
                            <tr id='addr0{{ forloop.counter }}'>
                                <td class="nnum">{{ forloop.counter }}</td>
                                <td style="width: 20%;">
                                    {% for j in estimateitem %}
                                    <div class="d-flex">
                                        <select name='product[]' id="product{{ forloop.counter }}" class="form-control product" style="background-color: #2f516f; color: white; ">
                                            <option value="{{j.item}}" >{{j.item}}</option>
                                
                                            {% for i in item %}
                                                {% if i.cid_id == cmp1.cid %}
                                                <option  value="{{ i.name  }}">{{ i.name  }} </option>
                                                {% endif %}
                                            {% endfor %}
        
                                        </select>

                                        <a href="#">
                                            <button type="button" class="btn btn-outline-secondary ml-1" data-target="#newitem" data-toggle="modal">+</button>
                                        </a>
                                    </div>
                                </td>
                                <td><input type="text" name='hsn[]' id="hsn{{ forloop.counter }}" placeholder='Enter HSN ' class="form-control" style="background-color: #2f516f; color: white;" value="{{j.hsn}}" /></td>
                                <td><input type="number" name='qty[]'  placeholder='Enter Qty' id="qty{{ forloop.counter }}"  class="form-control qty" step=0 min=0 style="background-color: #2f516f;margin-top: 21px; color: white;" value="{{j.quantity}}" />
                                    <div class="d-flex"><span>Available Qty :</span> <span id="qtyspan1" class=''></span></div>
                                </td>
                                <td><input type="number" name='price[]' id="unit{{ forloop.counter }}" placeholder='Enter Unit Price' class="form-control price" step="0.00" min="0" style="background-color: #2f516f; color: white;"  value="{{j.rate}}"/></td>
                                <td>
                                    <input hidden value="{{cmp1.state}}" id="cmpstate">
                                    <input type="text"  id="select_tax" placeholder="Tax Rate" class="form-control seltax d-flex">
                                    <select name='tax1[]' id="tax1{{ forloop.counter }}" class="form-control tax intra_tax d-none">
                                        <option selected value="{{j.tax}}">{{j.tax}}% GST ({{j.tax}}%)</option>
                                        <option value=28 >28.0% GST(28%)</option>
                                        <option value=18 >18.0% GST(18%)</option>
                                        <option value=12  >12.0% GST(12%)</option>
                                          <option value=5  >05.0% GST(05%)</option>
                                        <option value=3  >03.0% GST(03%)</option>
                                          <option value=0  >0.0% GST(0%)</option>
                                    </select>
                                    <select name='tax2[]' id="tax2{{ forloop.counter }}" class="form-control tax inter_tax d-none">
                                        <option selected value="{{j.tax}}">{{j.tax}}% IGST ({{j.tax}}%)</option>
                                        <option value=28 >28.0% IGST(28%)</option>
                                        <option value=18 >18.0% IGST(18%)</option>
                                        <option value=12  >12.0% IGST(12%)</option>
                                          <option value=5  >05.0% IGST(05%)</option>
                                        <option value=3  >03.0% IGST(03%)</option>
                                          <option value=0  >0.0% IGST(0%)</option>
                                    </select>
                                          
                                </td>
                                <td><input type="number" name='discount[]'  placeholder='Enter Discount' id="disc{{forloop.counter}}" value=0 class="form-control disc" step=0 min=0  value="{{j.discount}}" style="background-color: #2f516f;  color: white;"  /></td>

                                <td><input type="number" name='total[]' value="{{j.total}}" id="total1" placeholder=0 class="form-control total" value=0 step="any" readonly style="background-color: #2f516f; color: white;" /></td>
                                <td style="display: none;"><input type="number" step="any" name='taxamount1' id="taxamount1{{forloop.counter}}" class="form-control taxamount"/></td>

                                <td>
                                    <button type="button" id="{{forloop.counter}}" class="btn  font-weight-bold clone_row fas fa-clone px-2 my-1 py-1" title="Clone Row" style="background-color:rgb(88, 107, 143);"></button><br>
                                    <button type="button" id="{{forloop.counter}}" class="btn btn-danger remove_row px-2 py-1 mx-1 fas fa-close" title="Remove Row"> </button>
                                </td>
                            </tr>
                            </tbody>
                            <tr>
                                <td style="border: none;"><a class="btn btn-outline-secondary ml-1" role="button" id="add">+</a></td>
                            </tr>
                        </table>

                    </div>
                </div>
                <div class="row clearfix" style="margin-top:20px">
                    <div class="col-md-6">{% endfor %}
                        <textarea class="form-control"  id="" name="Note" placeholder="Note" style="height: 190px;"  value="{{estimate.note}}"></textarea>
                        <input type="file" name="file" value="{{estimate.file}}" style="margin-top: 10px; width: 70%;">
                    </div>
                    <div class="col-md-1"></div>
                    <div class="col-md-5 table-responsive-md mt-3" id="tab_logic_total" style="background-color:rgba(0,0,0,.4); border: 1px solid rgba(128, 128, 128, 0.6);">
                        <div class="p-3">
                            <div class="row container-fluid p-2 m-0">
                                <div class="col-sm-4 mt-2"><label class="text-center">Sub Total</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" step="any" name='subtotal' placeholder=0 value="{{estimate.subtotal}}"
                                    class="form-control" id="sub_total">
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>
                            <div class="row container-fluid p-2 m-0" id="igst1">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">IGST</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" name='igst' step="any" id="igst" placeholder=0 value="{{estimate.IGST}}"
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>
                            <!--<div class="row container-fluid p-2 m-0" style="display: none;" id="cgst1">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">CGST</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" name='cgst' step="any" id="cgst" placeholder=0 value="{{estimate.CGST}}"
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>
                            <div class="row container-fluid p-2 m-0" style="display: none;" id="sgst1">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">SGST</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" name='sgst' step="any" id="sgst" placeholder=0 
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>-->
                            <div class="row container-fluid p-2 m-0">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">Tax Amount</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" step="any" name='taxamount' id="tax_amount" placeholder='0.00' value="{{estimate.taxamount}}"
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>

                            </div>
                      
                            <div class="row container-fluid p-2 m-0">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">Shipping Charge</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" step="any" name='ship' id="ship" placeholder='0.00'  value=0 value="{{estimate.shipping_charge}}"
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>
                            <div class="row container-fluid p-2 m-0">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">Adjustment</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" step="any" name='adj' id="adj" placeholder='0.00' value="{{estimate.adjustment}}"
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>
                            <div class="row container-fluid p-2 m-0">
                                <div class="col-sm-4 mt-2"><label for="a" class="text-center">Grand Total</label></div>
                                <div class="col-sm-1 mt-2">:</div>
                                <div class="col-sm-7 mt-2"><input type="number" name='grandtotal' id="grandtotal" placeholder='0.00' readonly value="{{estimate.grandtotal}}"
                                    class="form-control"/>
                                </div>
                                <div class="col-sm-4 m-0 p-0"></div>
                            </div>
                        </div>
                    </div>
                </div>
               <!-- <div class="row">
                    <div class="col-md-10 mt-3"></div>
                    <div class="col-md-2 mt-3">
                    <button type="submit" class="btn btn-outline-info rounded-pill w-100 text-grey pull-left">
                        Save To Draft
                    </button>
                    </div>
                </div>-->



                        <div class="row">
                            <div class="col-md-4"></div>
                            <div class="col-md-4">
                                <button class="btn btn-outline-info rounded-pill text-grey w-100 mt-3 mb-3"
                                        type="submit">
                                    Submit form
                                </button>
                            </div>
                            <div class="col-md-4"></div>
                        </div>
                    {% endif %}
                </form>
            </div>
        </div>
    </div>


<!-- modal hsncode edit -->

<!--  modal -->

<div class="modal fade" id="customercreation">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background-color: #213b52;">
            <div class="modal-header">
                <h3 class="m-3">ADD CUSTOMER</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
  
                <form action="" method="POST" autocomplete="off" id="modalCustomer"> 
  
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="title">Title</label>
                            <select name="title" id="title" class="form-control" id="title">
                                <option value="Mr">Mr</option>
                                <option value="Mrs">Mrs</option>
                                <option value="Miss">Miss</option>
                                <option value="Ms">Ms</option>
                            </select>
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="firstname">First name</label>
                            <input type="text" class="form-control" id="firstname" name="firstname" 
                                   required style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="lastname">Last name</label>
                            <input type="text" class="form-control" id="lastname" name="lastname"
                                   required style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="company">Company</label>
                            <input type="text" class="form-control" id="company" name="company"
                                    style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="location">Location</label>
                            <input type="text" class="form-control" id="location" name="location"
                                    style="background-color: #2f516f;color: white;">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-4 mt-3"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="gsttype">GST type</label>
                            <select class="custom-select" id="gsttype" name="gsttype"
                                    onclick="hidinput('hello1',this)   "
                                    
                                    required
                                    style="background-color: #243e54; color: white;">
                                    <option selected disabled value="">Select GST Type</option>
                                    <option value="Registered Business - Regular">Registered Business - Regular <span><i>(Business that is registered under gst)</i></span></option>
                                    <option value="Registered Business - Composition">Registered Business - Composition (Business that is registered under composition scheme in gst)</option>
                                    <option value="unregistered Business">Unregistered Business (Business that has not been registered under gst)</option>
                                    <option value="Overseas">Overseas (Import/Export of supply outside india)</option>
                                    <option value="Consumer">Consumer</option>
                                    <option value="Special Economic Zone (SEZ)">Special Economic Zone (SEZ) (Business that is located in a special economic zone of india or a SEZ developer)</option>
                                    <option value="Demed Exports">Demed Exports (Supply of woods to an exports oriented unit or againsed advanced authorization or export promotion capital woods)</option>
                                    <option value="Tax Deductor">Tax Deductor (State of central gov,government agencies or local authority)</option>
                                    <option value="SEZ Developer">SEZ Developer (A person or organization who owns atleast 26% eqaulity in creating business units in special economic zone)</option>
                            </select>
                            <div class="invalid-feedback">Please select a valid registration type.</div>
                        </div>
  
                        <div class="col-md-4 mt-3 gstrow" id="hello1" style="display: none;">
                            <div >
                                <label for="gstin">GSTIN</label>
                                <input type="text" class="form-control" onchange="showMessage(this)"
                                       id="gstin" name="gstin"
                                       style="background-color: #2f516f;color: white;"
                                       value=""
                                       placeholder="29APPCK7465F1Z1">
                                       <a data-toggle="modal" href="#exampleModal"
                                style="color:#3dd5f3">Get Taxpayer Details</a>
                                <div class="text-danger m-2" id="warngst"></div>
                            </div>
                        </div>
  
                        <div class="col-md-4 mt-3">
                            <label for="panno">PAN NUMBER</label>
                            <input type="text" class="form-control" id="panno" name="panno"
                                    style="background-color: #2f516f;color: white;"
                                   onchange="checkpan(this)" placeholder="APPCK7465F">
                            <div class="text-danger m-2" id="warnpan"></div>
                        </div>
  
                        <div class="col-md-4 mt-3" >
                          <div>
                              <label for="openbalance">OPENING BALANCE</label>
                              <input type="text" class="form-control" id="openbalance" value=""  name="openbalance"
                                     
                                     style="background-color: #2f516f;color: white;"
                                     >
                              <div class="text-danger m-2" ></div>
                          </div>
                      </div>
  
                    </div>
  
                    <div class="row">
                        <div class="col-md-4 mt-3">
                            <label for="email">Email</label>
                            <input type="email" class="form-control" id="email" name="email"
                                    style="background-color: #2f516f;color: white;"
                                   placeholder="finsys@mail.com">
                            <div class="invalid-feedback">Please provide a valid Email</div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="website">Website</label>
                            <input type="text" class="form-control" id="website"
                                   placeholder="www.finsys.com" onchange="checkweb(this)" name="website"
                                   style="background-color: #2f516f;color: white;">
                            <div id="warnweb" class="text-danger"></div>
                        </div>
                        <div class="col-md-4 mt-3">
                            <label for="mobile">Mobile</label>
                            <input type="text" class="form-control" id="mobile"
                                   onchange="checkphone(this)" name="mobile"
                                    style="background-color: #2f516f;color: white;">
                            <div class="text-danger m-2" id="warnphone"></div>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-md-6 mt-5">
                            <div class="row">
                                <div class="col-md-12 card-title">
                                    <h5 class="mb-0">Billing Address</h5>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mt-3">
                                    <div class="form-row">
                                        <label for="street">Street</label>
                                        <textarea class="form-control street" id="street" name="street"
                                                  
                                                  style="background-color: #2f516f;color: white;"></textarea>
                                        <div class="invalid-feedback">Please provide a valid Street</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="city">City</label>
                                        <input type="text" class="form-control" id="city"
                                               name="city"
                                               
                                               style="background-color: #2f516f;color: white;" placeholder="City">
                                        <div class="invalid-feedback">Please provide a valid City</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="state">State</label>
                                        <select type="text" class="form-control" id="state" name="state"
                                            required style="background-color: #2f516f; color: white;">
                                            <option value="" disabled selected>Choose</option>
                                            <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                                            </option>
                                            <option value="Andhra Predhesh">Andhra Predhesh</option>
                                            <option value="Arunachal Predesh">Arunachal Predesh</option>
                                            <option value="Assam">Assam</option>
                                            <option value="Bihar">Bihar</option>
                                            <option value="Chandigarh">Chandigarh</option>
                                            <option value="Chhattisgarh">Chhattisgarh</option>
                                            <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                                            <option value="Damn anad Diu">Damn and Diu</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Goa">Goa</option>
                                            <option value="Gujarat">Gujarat</option>
                                            <option value="Haryana">Haryana</option>
                                            <option value="Himachal Predesh">Himachal Predesh</option>
                                            <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                            <option value="Jharkhand">Jharkhand</option>
                                            <option value="Karnataka">Karnataka</option>
                                            <option value="Kerala">Kerala</option>
                                            <option value="Ladakh">Ladakh</option>
                                            <option value="Lakshadweep">Lakshadweep</option>
                                            <option value="Madhya Predesh">Madhya Predesh</option>
                                            <option value="Maharashtra">Maharashtra</option>
                                            <option value="Manipur">Manipur</option>
                                            <option value="Meghalaya">Meghalaya</option>
                                            <option value="Mizoram">Mizoram</option>
                                            <option value="Nagaland">Nagaland</option>
                                            <option value="Odisha">Odisha</option>
                                            <option value="Puducherry">Puducherry</option>
                                            <option value="Punjab">Punjab</option>
                                            <option value="Rajasthan">Rajasthan</option>
                                            <option value="Sikkim">Sikkim</option>
                                            <option value="Tamil Nadu">Tamil Nadu</option>
                                            <option value="Telangana">Telangana</option>
                                            <option value="Tripura">Tripura</option>
                                            <option value="Uttar Predesh">Uttar Predesh</option>
                                            <option value="Uttarakhand">Uttarakhand</option>
                                            <option value="West Bengal">West Bengal</option>
                                            <option value="Other Territory">Other Territory</option>
                                        </select>
                                        <div class="invalid-feedback">Please provide a valid State</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="pincode">Pin Code</label>
                                        <input type="text" class="form-control" id="pincode"
                                               name="pincode"
                                                style="background-color: #2f516f;color: white;"
                                               placeholder="PIN code">
                                        <div class="invalid-feedback">Please provide a valid Pin Code</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="country">Country</label>
                                        <input type="text" class="form-control" id="country"
                                               name="country"
                                                style="background-color: #2f516f;color: white;"
                                               placeholder="Country">
                                        <div class="invalid-feedback">Please provide a valid Country</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mt-5">
                            <div class="row">
                                <div class="col-md-12 d-flex">
                                    <h5>Shipping Address</h5>
                                    <input class="ml-4 mt-2 ml-2" type="checkbox" onclick="poppins()" id="okay"
                                           name="okay">
                                    <label class="ml-2 mt-1 ml-2" for="okay">Same As Billing Address</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 mt-3">
                                    <div class="form-row">
                                        <label for="shipstreet">Street</label>
                                        <textarea class="form-control" id="shipstreet"
                                                  name="shipstreet"
                                                  
                                                  style="background-color: #2f516f;color: white;"></textarea>
                                        <div class="invalid-feedback">Please provide a valid Street</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shipcity">City</label>
                                        <input type="text" class="form-control" id="shipcity"
                                               name="shipcity"
                                               
                                               style="background-color: #2f516f;color: white;" placeholder="City">
                                        <div class="invalid-feedback">Please provide a valid City</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shipstate">State</label>
                                        <select type="text" class="form-control" id="shipstate" name="shipstate"
                                             style="background-color: #2f516f; color: white;">
                                            <option id="shipst" selected>Choose</option>
                                            <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                                            </option>
                                            <option value="Andhra Predhesh">Andhra Predhesh</option>
                                            <option value="Arunachal Predesh">Arunachal Predesh</option>
                                            <option value="Assam">Assam</option>
                                            <option value="Bihar">Bihar</option>
                                            <option value="Chandigarh">Chandigarh</option>
                                            <option value="Chhattisgarh">Chhattisgarh</option>
                                            <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                                            <option value="Damn anad Diu">Damn and Diu</option>
                                            <option value="Delhi">Delhi</option>
                                            <option value="Goa">Goa</option>
                                            <option value="Gujarat">Gujarat</option>
                                            <option value="Haryana">Haryana</option>
                                            <option value="Himachal Predesh">Himachal Predesh</option>
                                            <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                            <option value="Jharkhand">Jharkhand</option>
                                            <option value="Karnataka">Karnataka</option>
                                            <option value="Kerala">Kerala</option>
                                            <option value="Ladakh">Ladakh</option>
                                            <option value="Lakshadweep">Lakshadweep</option>
                                            <option value="Madhya Predesh">Madhya Predesh</option>
                                            <option value="Maharashtra">Maharashtra</option>
                                            <option value="Manipur">Manipur</option>
                                            <option value="Meghalaya">Meghalaya</option>
                                            <option value="Mizoram">Mizoram</option>
                                            <option value="Nagaland">Nagaland</option>
                                            <option value="Odisha">Odisha</option>
                                            <option value="Puducherry">Puducherry</option>
                                            <option value="Punjab">Punjab</option>
                                            <option value="Rajasthan">Rajasthan</option>
                                            <option value="Sikkim">Sikkim</option>
                                            <option value="Tamil Nadu">Tamil Nadu</option>
                                            <option value="Telangana">Telangana</option>
                                            <option value="Tripura">Tripura</option>
                                            <option value="Uttar Predesh">Uttar Predesh</option>
                                            <option value="Uttarakhand">Uttarakhand</option>
                                            <option value="West Bengal">West Bengal</option>
                                            <option value="Other Territory">Other Territory</option>
                                        </select>
                                        <div class="invalid-feedback">Please provide a valid State</div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shippincode">Pin Code</label>
                                        <input type="text" class="form-control" id="shippincode"
                                               name="shippincode"
                                                style="background-color: #2f516f;color: white;"
                                               placeholder="PIN code">
                                        <div class="invalid-feedback">Please provide a valid Pin Code</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mt-3">
                                    <div class="form-row">
                                        <label for="shipcountry">Country</label>
                                        <input type="text" class="form-control" id="shipcountry"
                                               name="shipcountry"
                                                style="background-color: #2f516f;color: white;"
                                               placeholder="Country">
                                        <div class="invalid-feedback">Please provide a valid Country</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="invalidCheck" required
                                       style="background-color: #2f516f;">
                                <label>Agree to terms and conditions</label>
                                <div class="invalid-feedback">You must agree before submitting.</div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4"></div>
                        <div class="col-md-4">
                            <button class="btn btn-outline-info rounded-pill text-grey w-100 mt-3 mb-3" data-dismiss="modal"
                                    type="submit" id="customerSave">
                                Submit form
                            </button>
                        </div>
                        <div class="col-md-4"></div>
                    </div>
  
                </form>
            </div>
        </div>
    </div>
  </div>
  
  
  <!-- modal item -->
  
  <div class="modal fade" id="newitem">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="background-color: #213b52;">
            <div class="modal-header">
                <h3 class="m-3">New Item</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="card p-3 m-3">
                    <form action="" method="post"  autocomplete="off" id="modalItem">
  
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-12 mx-0">
                                        <div class="row">
                                        <div class="col-md-6 mt-3">
                                            <label for="item_name"
                                                   style="color: white;">Name</label>
                                            <input type="text" name="name" class="form-control" id="item_name"
                                                      style="background-color: #2a4964; color: white;"
                                                     autocomplete="off" required>
                                        </div>
                                        <div class="col-md-6 mt-3">
                                            <label for="type"
                                                   style="color: white;">Type</label>
                                            <select name="type" class="form-control"  id="type"
                                                      style="background-color: #2a4964; color: white;"
                                                      required>
                                                      <option selected disabled value="">Choose...</option>
                                                    <option value="goods">Goods</option>
                                                <option value="services">Services</option></select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="row">
                                                <div class="col-md-12 mx-0">
                                                    <div class="row">
                                                        <div class="col-md-6 mt-3">
                                                            <label for="unit" style="color: white;">Unit
                                                                </label>
                                                            <div class="d-flex">
                                                                <select class="custom-select" name="unit" id="unit"
                                                                        required
                                                                        style="background-color: #2a4964; color: white;">
                                                                        <option selected disabled value="">Choose...</option>
                                                                        {% for a in unit %}
                                                                        <option style="text-transform:Uppercase;">{{ a.unit_symbol}}-{{ a.name }}</option>
                                                                        {% endfor %}
                                                                        <option>BAG-BAGS</option>
                                                                        <option>BAL-BALE</option>
                                                                        <option>BDL-BUNDLES</option>
                                                                        <option>BKL-BUCKLES</option>
                                                                        <option>BOX-BOX</option>
                                                                        <option>BOU-BILLIONS OF UNITS</option>
                                                                        <option>BTL-BOTTLES</option>
                                                                        <option>BUN-BUNCHES</option>
                                                                        <option>CAN-CANS</option>
                                                                        <option>CBM-CUBIC METER</option>
                                                                        <option>CMS-CENTIMETER</option>
                                                                        <option>CCM-CUBIC CENTIMETER</option>
                                                                        <option>CTN-CARTONS</option>
                                                                        <option>DOZ-DOZEN</option>
                                                                        <option>DRM-DRUM</option>
                                                                        <option>GGR-GREAT GROSS</option>
                                                                        <option>GMS-GRAMS</option>
                                                                        <option>GRS-GROSS</option>
                                                                        <option>GYD-GROSS YARDS</option>
                                                                        <option>KGS-KILOGRAMS</option>
                                                                        <option>KLR-KILOLITER</option>
                                                                        <option>KME-KILOMETRE</option>
                                                                        <option>MTS Metric ton</option>
                                                                        <option>MLT-MILLILITRE</option>
                                                                        <option>MTR-METERS</option>
                                                                        <option>NOS-NUMBER</option>
                                                                        <option>PAC-PACKS</option>
                                                                        <option>PCS-PIECES</option>
                                                                        <option>PRS-PAIRS</option>
                                                                        <option>QTL-QUINTAL</option>
                                                                        <option>ROL-ROLLS</option>
                                                                        <option>SQF-SQUARE FEET</option>
                                                                        <option>SET-SETS</option>
                                                                        <option>SQM-SQUARE METERS</option>
                                                                        <option>SQY-SQUARE YARDS</option>
                                                                        <option>TBS-TABLETS</option>
                                                                        <option>TGM-TEN GROSS</option>
                                                                        <option>THD-THOUSANDS</option>
                                                                        <option>TON-TONNES</option>
                                                                        <option>TUB-TUBES</option>
                                                                        <option>UGS-US GALLONS</option>
                                                                        <option>UNT-UNITS</option>
                                                                        <option>YDS-YARDS</option>
                                        
                                                                   
                                                                </select>
                                                                <!-- <a href="{% url 'add_unit' %}">
                                                                    <button type="button"
                                                                            class="btn btn-outline-secondary ml-1">+
                                                                    </button>
                                                                </a> -->
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6 mt-3">
                                                            <label for="hsn" style="color: white;">HSN
                                                                Code</label>
                                                        <input type="text" name="hsn" class="form-control" id="hsn"
                                                                   style="background-color: #2a4964; color: white;"
                                                                  
                                                                   placeholder="Enter a valid HSN code" required>
                                                          
                                                        </div>
                                                       
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6 mt-3">
                                                           
                                                        </div>
                                                       
                                                    </div>
                                                    
                                    <div class="row">
                                        <div class="col-md-3 mt-3">
                                            <label for="validationCustom05" name style="color: white;">Tax Reference
                                                </label>
                                         
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-check mt-1">
                                               
                                                    <input class="form-check-input" name="taxref" type="checkbox" id="inclusive"
                                                         value="taxable" checked >Taxable
                                                    <label style="color: white;">
                                                        </label>
                                              
                                            </div>
                                        </div>
                                        <div class="form-check mt-1">
                                            <input class="form-check-input" name="taxref" type="checkbox"
                                                   value="non taxable" 
                                                   id="check">
                                            <label style="color: white;">Non Taxable</label>
                                        </div>
                                    </div>
                                </div>
                                </div>
                                    <div class="row">
                                        <div class="col-md-6 mt-3">
                                            <label for="validationCustom01"
                                                   style="color: white;">Purchase Price</label>
                                                <div class="row">
                                                   <div >
                                                   <input type="text" class="form-control" value="INR"
                                                    style="margin-left:20px;width:60px;background-color: #2a4960; color: white;"></div>
                                                   <div >
                                                   <input type="number" name="pcost" class="form-control" 
                                                   id="purprice" style="width:540px;background-color: #2a4964; color: white; width:200%"
                                                   value="0"
                                                   >
                                                   </div>
                                                </div>
  
                                        </div>
                                        <div class="col-md-6 mt-3">
                                            <label for="validationCustom01"
                                                   style="color: white;">Sales Price</label>
                                                   <div class="row">
                                                    <div >
                                                        <input type="text" class="form-control" value="INR"
                                                         style="margin-left:20px;width:60px;background-color: #2a4960; color: white;"></div>
                                                        <div >
                                                    <div >
                                                   <input type="text" name="salesprice" class="form-control"
                                                   id="saleprice" style="width:540px;background-color: #2a4964; color: white; width:200%"
                                                   value="0"
                                                   >
                                                    </div>
                                                </div>
  
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 mx-0">
                                        <div class="row">
                                            <div class="col-md-6 mt-3">
                                                <label for="validationCustom01"
                                                       style="color: white;">Account</label>
                                                       <select name="pur_account" class="form-control" 
                                                       style="background-color: #2a4964; color: white;"
                                                       id="pur_account" >
                                                       <option >Cost of Goods Sold</option>
                                                       {% for a in acc %}
                                                       <option value="goods">{{ a.name }}</option>
                                                       {% endfor %}</select>
                                            </div>
                                            <div class="col-md-6 mt-3">
                                                <label for="validationCustom01"
                                                       style="color: white;">Account</label>
                                                <select name="sale_account" class="form-control" 
                                                          style="background-color: #2a4964; color: white;"
                                                          id="sale_account" >
                                                          <option >Sales</option>
                                                       {% for a in acc1 %}
                                                       <option value="goods">{{ a.name }}</option>
                                                       {% endfor %}</select>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-12 mx-0">
                                                <div class="row">
                                                    <div class="col-md-6 mt-3">
                                                        <label for="validationCustom01"
                                                               style="color: white;">Description</label>
                                                               <textarea class="form-control" name="pur_desc"
                                                               id="pur_desc" 
                                                               style="background-color: #2a4964; color: white;"
                                                               ></textarea>  
                                                    </div>
                                                    <div class="col-md-6 mt-3">
                                                        <label for="validationCustom01"
                                                               style="color: white;">Description</label>
                                                               <textarea class="form-control" name="sale_desc"
                                                               id="sale_desc"
                                                               style="background-color: #2a4964; color: white;"
                                                               ></textarea>
                                                    </div>
                                                </div>
                                     
                                    
                                    <div class="row">
                                        <div class="col-md-12 mx-0">
                                            <div class="row">
                                                <div class="col-md-6 mt-3">
                                                    <label for="validationCustom01"
                                                           style="color: white;">Intra State Tax Rate</label>
                                                           <select name="intra_st" class="form-control" 
                                                           style="background-color: #2a4964; color: white;"
                                                           id="intra_st" >
                                                           <option >Choose...</option>
                                                           <option value=0>GST 0 (0%)</option>
                                                           <option value=5>GST 5 (5%)</option>
                                                           <option value=12>GST 12 (12%)</option>
                                                           <option value=18>GST 18 (18%)</option>
                                                           <option value=28>GST 28 (28%)</option>
                                                           <option value=0>Out of Scope(0%)</option>
                                                </select>
                                                </div>
                                            
                                                <div class="col-md-6 mt-3">
                                                    <label for="inter_st"
                                                           style="color: white;">Inter State Tax Rate</label>
                                                    <select name="inter_st" class="form-control" 
                                                              style="background-color: #2a4964; color: white;"
                                                              id="inter_st" >
                                                              <option >Choose...</option>
                                                              <option value=0>IGST 0 (0%)</option>
                                                           <option value=5>IGST 5 (5%)</option>
                                                           <option value=12>IGST 12 (12%)</option>
                                                           <option value=18>IGST 18 (18%)</option>
                                                           <option value=28>IGST 28 (28%)</option>
                                                           <option value=0>Out of Scope(0%)</option>
                                                </select>
                                                </div>
                                            </div><br>
                                            <div class="row" >
                                               
                                               
                                  
                                                <div class="col-md-3">
                                                    <div class="form-check">
                                                        <input class="form-check-input" onclick="ShowHideDiv(this)" type="checkbox"  id="track">
                                                        <label class="form-check-label" for="track" >
                                                          Track Inventory
                                                        </label>
                                                      </div>
                                                     
                                                </div>
                                            
                                            </div>
  
                                            <div class="row" id="inventorytrack" style="display: none">
                                                <div class="col-md-6 mt-3">
                                                    <label for="validationCustom01"
                                                           style="color: white;">Inventory Account</label>
                                                           <select name="invacc" class="form-control" id="invacc"
                                                              style="background-color: #2a4964; color: white;"
                                                              >
                                                           <option selected disabled value="" >Choose...</option>
                                                           <option value="Inventory Assets">Inventory Assets</option>
                                                       
                                                </select>
                                                </div>
                                                <div class="col-md-6 mt-3">
                                                    <label for="validationCustom01"
                                                           style="color: white;">Stock on hand</label>
                                                           <input type="number" name="stock" class="form-control" id="stock"
                                                           style="width:540px;background-color: #2a4964; color: white;"
                                                           value="0"
                                                           >
                                                </div>
                                            </div>
                                           
  
                                        
                           
                                            <div class="row">
                                                <div class="col-md-6 mt-3">
                                                   
                                                </div>
                                               
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3 mt-3">
                                                    <label for="validationCustom05" name style="color: white;">Active/Inactive
                                                        </label>
                                                 
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="form-check">
                                                        <input class="form-check-input" value="Active" type="radio" name="status" id="flexRadioDefault1" checked>
                                                        <label class="form-check-label" for="flexRadioDefault1">
                                                          Active
                                                        </label>
                                                      </div>
                                                     
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" value="Inactive" type="radio" name="status" id="flexRadioDefault2" >
                                                    <label class="form-check-label" for="flexRadioDefault2">
                                                      Inactive
                                                    </label>
                                                  </div>
                                            </div>
                                        </div>
                                        </div>
                                   
                                    <div class="row mt-5 mb-5">
                                        <div class="col-md-4">
                                            <a href="{% url 'goewaybill' %}"class="btn btn-outline-info rounded-pill w-25 text-light">BACK</a>                                   </div>
                                        <div class="col-md-4">
                                            <button class="btn btn-outline-info rounded-pill w-100 text-light" data-dismiss="modal" type="submit" id="itemSave">SUBMIT</button>
                                        </div>
                                        <div class="col-md-4"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
              </div>
          </div>
      </div>
  </div> 
  </div> 
  
    
<!---------------------------------------------ADD Transporter MODAL ----------------------------------------------->

<div class="modal fade" id="newtransporter">
    <div class="modal-dialog">
   
        <div class="modal-content" style="background-color: #213b52;">
            <form action="{% url 'create_transporter' %}" method="post" class="needs-validation"  validate>
                {% csrf_token %}
            <div class="modal-header">
                <h3 class="m-3">Add Transporter</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
              
              
                <div>
                    <div class="form-check">
                        <label class="form-check-label">Name *</label> 
                        <input type="text" class="form-control" name="tname">
                       
                    </div>

                    <div class="form-check">
                        <label class="form-check-label">Transporter's ID *</label> 
                        <input type="text" class="form-control" name="tid">
                       
                    </div>

    
                </div>
           
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-outline-info" >Save</button>
                <button type="button" class="btn btn-outline-info" data-dismiss="modal">Close</button>
            </div>
        </form>
        </div>
 
    </div>
</div>            


    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        
        $(document).ready(function () {
                $('#customer').on('change', function() {
                    console.log($('#customer').val())
                    $.ajax({
                        type : 'POST',
                        
                        url: "{% url 'cust_details' %}",
                        data: {
                            id: $('#customer').val(),
                            csrfmiddlewaretoken: '{{ csrf_token }}',
                        },
                        
                        success: function(data){
                            console.log(data.email);
                            document.getElementById('est_email').value = data.email;
                            document.getElementById('e_gstin').value = data.gstin;
                            document.getElementById('bname').value = data.street + '\n' + data.city + '\n' + data.state + '\n' + data.country  + '\n' + data.pincode ;
                        }
                    });
                });
            });

            function insertValue() {
            var select = document.getElementById("select"),
            txtVal = document.getElementById("val").value,
            newOption = document.createElement("OPTION"),
            newOptionval = document.createTextNode(txtVal);
            newOption.appendChild(newOptionval);
            select.insertBefore(newOption, select.lastChild);
        }
        
        $('.datepicker').pickadate({
            selectMonths: true,
            selectYears: true
        }),
        $('.timepicker').pickatime()
        
        $(function () {
            $('#date-time').bootstrapMaterialDatePicker({
                format: 'YYYY-MM-DD HH:mm'
            });
            $('#date').bootstrapMaterialDatePicker({
                time: false
            });
            $('#time').bootstrapMaterialDatePicker({
                date: false,
                format: 'HH:mm'
            });
        });           

function reloadCustomer() {

$.ajax({
    url: "{% url 'cust_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
        var dropdown = $('#customer');
        dropdown.empty();
    dropdown.append(`<option selected>Select Customer</option>`);
        $.each(data, function(key, value) {
            console.log(value)
            dropdown.append($('<option></option>').attr('value', key).text(value[1] + " " +value[2] + " "+ value[3]).val(value[0] + " " +value[2] + " "+ value[3]));
        });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
});
}

   $(document).on('change', '.product',function(){ 
                
                var n = $(this).attr("id").slice(7);
                console.log(n)
                $.ajax({
                url: "{% url 'itemdata' %}",
                type : 'GET',
                data:{
                    id : $(this).val(),
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                
                success: function(response) {
                    data = response.hsn
                    data2 = response.qty
                    data3 = response.price
                    data4 = response.gst
                    data5 = response.sgst

                    console.log(data)
                    
                    document.getElementById('hsn'+n).value = data;
                    document.getElementById('qtyspan'+n).innerHTML = data2;
                    document.getElementById('unit'+n).value = data3;

                },
                });
                

            });
            // $('#date').val(new Date().toJSON().slice(0,10));
            $(document).on('click','.remove_row',function(){
                var row_id = $(this).attr("id");
                $('#addr0'+row_id+'').remove();
                
                calc();
            });
        

            $(document).on('click','.clone_row',function(){
                var roinc = $("#items-table-body tr").length;
                var originalRow = $(this).closest('#items-table-body tr'); 
                var clonedRow = originalRow.clone();

                clonedRow.attr('id', 'addr0' +(roinc+1));

                clonedRow.find('.nnum').text(roinc+1);

                clonedRow.find('[id]').each(function() {
                    var oldId = $(this).attr('id');
                    var newId = oldId.replace(/\d+/, roinc+1);
                    console.log(newId)
                    $(this).attr('id', newId );
                });

                clonedRow.find('.product').each(function() {
                    $(this).val(originalRow.find('.product').val());
                });
                clonedRow.find('.intra_tax').each(function() {
                    $(this).val(originalRow.find('.intra_tax').val());
                });
                clonedRow.find('.inter_tax').each(function() {
                    $(this).val(originalRow.find('.inter_tax').val());
                });
                originalRow.after(clonedRow);
                
                calc();
                
            });
            
           
  
        function poppins() {
            var chkbtn = document.getElementById('okay');
            if (chkbtn.checked == true) {
                document.getElementById('shipstreet').value = document.getElementById('street').value;
                document.getElementById('shipcity').value = document.getElementById('city').value;
                document.getElementById('shippinco').value = document.getElementById('pinco').value;
                document.getElementById('shipcountry').value = document.getElementById('country').value;
                document.getElementById('shipst').value = document.getElementById('state').value;
                document.getElementById('shipst').innerHTML = document.getElementById('state').value;
            } else {
                document.getElementById('shipstreet').value = '';
                document.getElementById('shipcity').value = '';
                document.getElementById('shipstate').value = '';
                document.getElementById('shippinco').value = '';
                document.getElementById('shipcountry').value = '';
            }
        }
    </script>

    <script>
        function showgsttyp(){
            var status = document.getElementById("gsttyp");
            var a = status.value
            console.log(a);
            if( a == "Registered Business - Regular" ){
                console.log(a);

                document.getElementById('regular').style.display = "flex";
                // document.getElementById('trade').style.display = "block";
                // document.getElementById('legal').style.display = "block";
                // document.getElementById('tax').style.display = "block";
                document.getElementById('comp').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "Registered Business - Composition" ){
                document.getElementById('comp').style.display = "flex";
                document.getElementById('tax').style.display = "none";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "unregistered Business" ){
                document.getElementById('unreg').style.display = "flex";
                // document.getElementById('tax').style.display = "block";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('comp').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "Overseas" ){
                document.getElementById('overseas').style.display = "flex";
                document.getElementById('tax').style.display = "none";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('comp').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "Special Economic Zone (SEZ)" ){
                document.getElementById('sez').style.display = "flex";
                document.getElementById('tax').style.display = "none";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('comp').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "Demed Exports" ){
                document.getElementById('demed').style.display = "flex";
                document.getElementById('tax').style.display = "none";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('comp').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "Tax Deductor" ){
                document.getElementById('taxdud').style.display = "flex";
                document.getElementById('tax').style.display = "none";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('comp').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('sezdev').style.display = "none";
            }
            else if( a == "SEZ Developer" ){
                document.getElementById('sezdev').style.display = "flex";
                document.getElementById('tax').style.display = "none";
                document.getElementById('trade').style.display = "none";
                document.getElementById('legal').style.display = "none";
                document.getElementById('demed').style.display = "none";
                document.getElementById('sez').style.display = "none";
                document.getElementById('unreg').style.display = "none";
                document.getElementById('comp').style.display = "none";
                document.getElementById('regular').style.display = "none";
                document.getElementById('overseas').style.display = "none";
                document.getElementById('taxdud').style.display = "none";
            }
        }

    </script>

    <script>
        function hidinput(divId, element) {
            if (element.value == 'unregistered Business' || element.value == 'Consumer' || element.value == 'Overseas') {
                document.getElementById(divId).style.display = 'none';
            } else {
                document.getElementById(divId).style.display = 'block';
            }
        }

        function checkgst(element) {
            var gstinput = element.value;
            var gstregexp = "[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}";
            if (gstinput.match(gstregexp)) {
                document.getElementById('warngst').innerHTML = '';
            } else {
                document.getElementById('warngst').innerHTML = 'Please provide a valid GSTIN';
                alert('Please provide a valid GSTIN');
            }
        }









        
$(document).ready(function() {
  $("#gsttype").change(function() {
  var x=$('#gsttype').val();
  if(x=="unregistered Business") 
  {
      $(".gstrow").removeClass('d-block');
      $(".gstrow").addClass('d-none');

  }
  else if(x == 'Overseas'){
      $(".gstrow").removeClass('d-block');
      $(".gstrow").addClass('d-none');
  }
  else if(x == 'Consumer'){
      $(".gstrow").removeClass('d-block');
      $(".gstrow").addClass('d-none');
  }
  else 
  {
      $(".gstrow").removeClass('d-none');
      $(".gstrow").addClass('d-block');
  }
  
  });
});

$(document).ready(function() {


var bc = document.getElementById("plosu").value;
var compstate = document.getElementById("cmpstate").value;
if (bc == compstate ) {
document.getElementById('cgst1').style.display = 'flex';
document.getElementById('sgst1').style.display = 'flex';
document.getElementById('igst1').style.display = 'none'; 

} else {
document.getElementById('cgst1').style.display = 'none';
document.getElementById('sgst1').style.display = 'none';
document.getElementById('igst1').style.display = 'flex';

}

});

// create customer--------------------------

$(document).on("click", "#customerSave", function(){

$.ajax({

type : 'POST',
url:"{% url 'customers21' %}",

data:{

title : $('#title').val(),
first_name : $('#firstname').val(),
last_name : $('#lastname').val(),
company_name : $("#company").val(),
location : $("#location").val(),
openbalance : $("#openbalance").val(),
email : $("#email").val(),
website :$("#website").val(),
mobile :$("#mobile").val(),
street : $("#street").val(),
city : $("#city").val(),
state : $("#state").val(),
country : $("#country").val(),
pincode : $("#pincode").val(),
shipstreet : $("#shipstreet").val(),
shipcity : $("#shipcity").val(),
shipstate : $("#shipstate").val(),
shipcountry : $("#shipcountry").val(),
shippincode : $("#shippincode").val(),
gsttype :$("#gsttype").val(),
gstin :$("#gstin").val(),
panno :$("#panno").val(),


csrfmiddlewaretoken: '{{ csrf_token }}',

},

success: function(response) {
console.log("success")
document.getElementById("modalCustomer").reset();
reloadCustomer();
},
});        
});


// item modal

$(document).on("click","#itemSave",function(){
  var taxref,status1;

  if ($('#inclusive').checked) {
      tax= $('#inclusive').val();
   } 
   else if($('#check').val()){
      tax = $('#check').val();
   }
   else 
  {
   console.log("Checkbox is not checked.");
  }

  console.log(tax);
  if ($('input[name="status"]:checked').val() == 'Active'){

      status1 = $('#flexRadioDefault1').val();
  }
  else{
      status1 = $('#flexRadioDefault2').val();
  }

  $.ajax({
  
  type : 'POST',
  url:"{% url 'credit_item' %}",
  
  data:{
      type : $("#type").val(),
      name : $("#item_name").val(),
      unit : $("#unit").val(),
      hsn : $("#hsn").val(),
      taxref : tax,
      sell_price : $("#saleprice").val(),
      cost_price : $("#purprice").val(),
      sell_acc : $("#sale_account").val(),
      cost_acc : $("#pur_account").val(),
      sell_desc : $("#sale_desc").val(),
      cost_desc : $("#pur_desc").val(),
      intra_st : $("#intra_st").val(),
      inter_st : $("#inter_st").val(),
      invacc : $("#invacc").val(),
      stock : $("#stock").val(),
      status : status1,
      csrfmiddlewaretoken: '{{ csrf_token }}',
      
      },
  
      success: function(response) {
          console.log(response)
          document.getElementById("modalItem").reset();
          reloadItem();
      },
  });        
  });


function reloadItem() {
  $.ajax({
  url: "{% url 'item_dropdown' %}",
  type: "GET",
  dataType: "json",
  data: $(this).serialize(),
  csrfmiddlewaretoken: '{{ csrf_token }}',

  success: function(data) {
      var dropdown = $('.product');
      console.log(data)
      dropdown.empty();
      dropdown.append(`<option selected>Select Item</option>`);
      $.each(data, function(key, value) {
      
          dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
      });

  },
  error: function(xhr, status, error) {
  console.error(xhr.responseText);
  }
  });
  }









  
  $(document).on("click",".seltax",function(){
      
      $(".seltax").removeClass('d-flex');
      $(".seltax").addClass('d-none');

      console.log($("#plosu").val());
      console.log($("#cmpstate").val());

      if($("#plosu").val() == $("#cmpstate").val()){
          console.log("yes");
          $(".inter_tax").removeClass('d-flex');
          $(".inter_tax").addClass('d-none');

          $(".intra_tax").removeClass('d-none');
          $(".intra_tax").addClass('d-flex');
          
      }
      else{
          console.log("no");
          $(".intra_tax").removeClass('d-flex');
          $(".intra_tax").addClass('d-none');

          $(".inter_tax").removeClass('d-none');
          $(".inter_tax").addClass('d-flex');
      }

  });

  $(document).on('change','#plosu',function()   {
      $(".seltax").removeClass('d-none');
      $(".seltax").addClass('d-flex');
      $(".intra_tax").removeClass('d-flex');
      $(".intra_tax").addClass('d-none');
      $(".inter_tax").removeClass('d-flex');
      $(".inter_tax").addClass('d-none');
      var bc = document.getElementById("plosu").value;
      var compstate = document.getElementById("cmpstate").value;
      if (bc == compstate ) {
          document.getElementById('cgst1').style.display = 'flex';
          document.getElementById('sgst1').style.display = 'flex';
          document.getElementById('igst1').style.display = 'none'; 

      } else {
          document.getElementById('cgst1').style.display = 'none';
          document.getElementById('sgst1').style.display = 'none';
          document.getElementById('igst1').style.display = 'flex';

      }
          
  });




  $(document).ready(function(){
   $('#add').click(function(){
    var table = document.getElementById("items-table-body");
               var roinc = table.rows.length;
               var bc = document.getElementById("plosu").value;
               var compstate = document.getElementById("cmpstate").value;
               
               roinc++;
  $('#items-table-body').append(


  `
  <tr id='addr0${roinc}'>
    <td class = 'nnum'>${roinc}</td>
                    <td style="width: 20%;">
                      <div class="d-flex">
                      <select name='product[]' id="product${roinc}" class="form-control product" style="background-color: #2f516f; color: white;">
                        <option value=" " selected>Select Product</option>
                        
                        {% for i in item %}
                                {% if i.cid_id == cmp1.cid %}
                                    <option 
                                            value="{{ i.name  }}">{{ i.name  }} </option>
                                {% endif %}
                            {% endfor %}
        
                            
                        
                               
                              </select>

                            <a href="#">
                                <button type="button" class="btn btn-outline-secondary ml-1" 
                                data-target="#newitem" data-toggle="modal">+</button>
                            </a>
                        </div>
                    </td>
                    <td><input type="text" name='hsn[]' id="hsn${roinc}" placeholder='Enter HSN Code' class="form-control" style="background-color: #2f516f; color: white;" /></td>
                     <td><input type="number" name='qty[]' placeholder='Enter Qty' id="qty${roinc}" class="form-control qty" step=0 min=0 style="background-color: #2f516f;margin-top: 21px; color: white;" />
                      <div class='d-flex'><span>Available Qty :</span> <span id="qtyspan${roinc}"class=''></span></div>
                    </td>
                    <td><input type="number" name='price[]' id="unit${roinc}" placeholder='Enter Unit Price' class="form-control price" step="0.00" min="0" style="background-color: #2f516f; color: white;" /></td>
                    <td>
                      <input type="text"  id="select_tax" placeholder="Tax Rate" class="form-control seltax d-flex">

                      <select name='tax1[]' id="tax1${roinc}" class="form-control tax intra_tax d-none">
                          <option selected disabled > Select GST</option>
                          <option value=28 >28.0% GST(28%)</option>
                          <option value=18 >18.0% GST(18%)</option>
                          <option value=12  >12.0% GST(12%)</option>
                              <option value=5  >05.0% GST(05%)</option>
                          <option value=3  >03.0% GST(03%)</option>
                              <option value=0  >0.0% GST(0%)</option>
                      </select>
                      <select name='tax2[]' id="tax2${roinc}" class="form-control tax inter_tax d-none">
                          <option selected disabled  >Select IGST</option>
                          <option value=28 >28.0% IGST(28%)</option>
                          <option value=18 >18.0% IGST(18%)</option>
                          <option value=12  >12.0% IGST(12%)</option>
                              <option value=5  >05.0% IGST(05%)</option>
                          <option value=3  >03.0% IGST(03%)</option>
                              <option value=0  >0.0% IGST(0%)</option>
                      </select>
                      
                    </td>  
                    <td>
                      <input type="number" name='discount[]' placeholder='Enter Discount' value=0 id="disc${roinc}" class="form-control disc" step=0 min=0>
                    </td>
                    <td><input type="number" name='total[]' id="total${roinc}" placeholder=0 class="form-control total" value=0 step="any" readonly style="background-color: #2f516f; color: white;" /></td>
                    <td style="display: none;"><input type="number" step="any" name='taxamount1' id="taxamount${roinc}" class="form-control taxamount" />
                    </td>
                    <td>
                      <button type="button" id="${roinc}" class="btn  font-weight-bold clone_row fas fa-clone px-2 py-1 my-1" style="background-color:rgb(88, 107, 143);"></button><br>
                      <button type="button" id="${roinc}" class="btn btn-danger px-2 mx-1 py-1 remove_row fas fa-close"></button>
                    </td>
                  </tr>
  
  `
    
 
 );
 $('.product').each(function(index, dropdown) {
                    var row = $(dropdown).closest('.items-table-body'); // Assuming each row has a class 'item-row'
                    $.ajax({
                        url: "{% url 'item_dropdown' %}",
                        type: "GET",
                        dataType: "json",
                        data: row.find('select').serialize(),
                        csrfmiddlewaretoken: '{{ csrf_token }}',

                        success: function(data) {
                            var dropdown = $('.product');
                            dropdown.empty();
                            dropdown.append(`<option selected>Select Item</option>`);
                            $.each(data, function(key, value) {
                            
                                dropdown.append($('<option></option>').attr('value', key).text(value).val(value));
                            });

                        },
                        error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                        }
                    });
                });
  });
  });

  // calculation---------------------------

  $(document).on('change', '.product',function(){ 
                
                var n = $(this).attr("id").slice(7);
                console.log('item changed')
                console.log(n)
                $.ajax({
                url: "{% url 'itemdata' %}",
                type : 'GET',
                data:{
                    id : $(this).val(),
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                
                success: function(response) {
                    data = response.hsn
                    data2 = response.qty
                    data3 = response.price
                    data4 = response.gst
                    data5 = response.sgst

                    // console.log(data)
                    // console.log(data2)
                    // console.log(data3)
                    document.getElementById('hsn'+n).value = data;
                    document.getElementById('qtyspan'+n).innerHTML = data2;
                    document.getElementById('unit'+n).value = data3;

                },
                });
                

            });

            $(document).on('click','.remove_row',function(){
                var row_id = $(this).attr("id");
                $('#addr0'+row_id+'').remove();
                
                calc();
            });
        

            $(document).on('click','.clone_row',function(){
                var roinc = $("#items-table-body tr").length;
                var originalRow = $(this).closest('#items-table-body tr'); 
                var clonedRow = originalRow.clone();

                clonedRow.attr('id', 'addr0' +(roinc+1));

                clonedRow.find('.nnum').text(roinc+1);

                clonedRow.find('[id]').each(function() {
                    var oldId = $(this).attr('id');
                    var newId = oldId.replace(/\d+/, roinc+1);
                    console.log(newId)
                    $(this).attr('id', newId );
                });

                clonedRow.find('.product').each(function() {
                    $(this).val(originalRow.find('.product').val());
                });
                clonedRow.find('.intra_tax').each(function() {
                    $(this).val(originalRow.find('.intra_tax').val());
                });
                clonedRow.find('.inter_tax').each(function() {
                    $(this).val(originalRow.find('.inter_tax').val());
                });
                originalRow.after(clonedRow);
                
                calc();
                
            });
            $(document).ready(function(){

            
            $('#items-table-body').on('keyup change', function () {
                calc();
            });

            $('#tax').on('keyup change', function () {
                calc_total();
            });
          });

        function calc() {
            $('#tab_logic tbody tr').each(function () {
                var html = $(this).html();
                if (html != '') {
                    var qty = $(this).find('.qty').val();
                    
                    var price = $(this).find('.price').val();

                    var dis = $(this).find('.disc').val();
                    console.log(qty)
                    console.log(typeof(qty))
                    
                    console.log(price)
                    console.log(typeof(price))
                    console.log(parseFloat(dis))
                    console.log(typeof(parseFloat(dis)))
                    var bc = $("#plosu").val();
                    var compstate = $("#cmpstate").val();
                    if(bc==compstate){
                        tax = $(this).find('.intra_tax').val();
                    }
                    else{
                        tax = $(this).find('.inter_tax').val();
                    }
                    console.log((parseFloat(qty) *parseFloat(price))-parseFloat(dis))
                    $(this).find('.total').val((parseFloat(qty) *parseFloat(price))-parseFloat(dis));
                    $(this).find('.taxamount').val(((qty * price)-dis) * (tax / 100));
                    calc_total();
                }
            });
        }

        function calc_total() {
             
            total = 0;
            $('.total').each(function () {
                total += parseFloat($(this).val());
            });
            taxamount = 0;
            $('.taxamount').each(function () {
                taxamount += parseFloat($(this).val());
            });
            $('#sub_total').val(total.toFixed(2));
            $('#tax_amount').val(taxamount.toFixed(2));
            ship = parseFloat($("#ship").val());
            // console.log( ship);
            gtot = taxamount + total + ship;
            $('#grandtotal').val(gtot.toFixed(2));
            $('#baldue').val(gtot.toFixed(2));

            test()
        }

        function test(){
                     
            var bc = $("#plosu").val();
            var compstate = $("#cmpstate").val();
            d=0
            if (bc == compstate  ) {
                gst = taxamount/2
                $('#cgst').val(parseFloat(gst.toFixed(2)));
                $('#sgst').val(parseFloat(gst.toFixed(2)));
                $('#igst').val(parseFloat(d.toFixed(2)));
            }
                
            if (bc != "{{ cmp1.state }}"  ) {
                $('#igst').val(taxamount.toFixed(2));
                $('#cgst').val(d.toFixed(2));
                $('#sgst').val(d.toFixed(2));
            }

           
        }
        function showinnum(divId, element) {
            if (element.value) {
                document.getElementById(divId).innerHTML = "Debit Note " + element.value;
            } else {
                document.getElementById(divId).innerHTML = "Debit Note";
            }
        }

        $(document).on('keyup',"#ship",function(){
            var subtot = $('#sub_total').val();
            var tax = $('#tax_amount').val();
            var sh = $("#ship").val();
            $('#grandtotal').val((parseFloat(subtot)+parseFloat(tax)+parseFloat(sh)).toFixed(2));
            $('#baldue').val((parseFloat(subtot)+parseFloat(tax)+parseFloat(sh)).toFixed(2));
        });

        $(document).on("change", "#adj", function(){
            var round = parseFloat($("#grandtotal").val()) + parseFloat($("#adj").val()) 
            $("#grandtotal").val(round);
            $('#baldue').val(round);
        });

  $(document).on('click','.remove_row',function(){
  var row_id = $(this).attr("id");
  $('#addr0'+row_id+'').remove();
  });
        function poppins() {
            var chkbtn = document.getElementById('okay');
            if (chkbtn.checked == true) {
                document.getElementById('shipstreet').value = document.getElementById('street').value;
                document.getElementById('shipcity').value = document.getElementById('city').value;
                document.getElementById('shippincode').value = document.getElementById('pincode').value;
                document.getElementById('shipcountry').value = document.getElementById('country').value;
                document.getElementById('shipstate').value = document.getElementById('state').value;
                document.getElementById('shipst').innerHTML = document.getElementById('state').value;
            } else {
                document.getElementById('shipstreet').value = '';
                document.getElementById('shipcity').value = '';
                document.getElementById('shipstate').value = '';
                document.getElementById('shippincode').value = '';
                document.getElementById('shipcountry').value = '';
            }
        }
  
        function hidinput(divId, element) {
            if (element.value == 'GST-registered-Regular') {
                document.getElementById(divId).style.display = 'block';
            } else {
                document.getElementById(divId).style.display = 'none';
            }
        }

        
        function showMessage(input) {
            const gstin = input.value;

            if (gstin.length === 15) {
                // document.getElementById("message").textContent = "Please wait, validating GSTIN format...";
                setTimeout(() => checkgst(input), 500);  // Wait for a second and then validate GSTIN
            } else {
                document.getElementById("message").textContent = "";
            }
        }


        function checkgst(element) {
            var gstinput = element.value;
            var gstregexp = "[0-9]{2}[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}[1-9A-Za-z]{1}[Z]{1}[0-9a-zA-Z]{1}";
            if (gstinput.match(gstregexp)) {
                document.getElementById('warngst').innerHTML = '';
            } else {
                document.getElementById('warngst').innerHTML = 'Please provide a valid GST Number';
                alert('Please provide a valid GST Number');
            }
        }

        function checkpan(element) {
            var paninput = element.value;
            var panregexp = ["[a-zA-Z]{5}[0-9]{4}[a-zA-Z]{1}"]
            if (paninput.match(panregexp)) {
                document.getElementById('warnpan').innerHTML = '';
            } else {
                document.getElementById('warnpan').innerHTML = 'Please provide a valid PAN Number';
                alert('Please provide a valid PAN Number')
            }
        }

        function checkweb(element) {
            var webinput = element.value;
            var webregexp = "www."
            if (webinput.startsWith(webregexp)) {
                document.getElementById('warnweb').innerHTML = '';
            } else {
                document.getElementById('warnweb').innerHTML = 'Please provide a valid Website Address';
                alert('Please provide a valid Website Address')
            }
        }

        function checkphone(element) {
            var phoneinput = element.value;
            var phoneregexp = "[0-9]{10}";
            if (phoneinput.match(phoneregexp)) {
                document.getElementById('warnphone').innerHTML = '';
            } else {
                document.getElementById('warnphone').innerHTML = 'Please provide a valid Phone Number';
                alert('Please provide a valid Phone Number')
            }
        }
        
  function showinp(divId, element) {
    if (element.value == 'Add New Term') {
      document.getElementById(divId).style.display = 'block';
    } else {
      document.getElementById(divId).style.display = 'none';
    }
  }

  function addtemopt(element) {
    var opt = document.getElementById('trmopt');

    if (element.value) {
      opt.value = element.value;
      opt.innerHTML = element.value;
    } else {
      pass
    }
  }
  

  $('#termadd').on('change', function() {

      
select = $('#termadd').val();
$.ajax({
  type: "GET",
  url: "{% url 'getterm' %}",
  data: {
    id: select
  }
}).done(function(response) {
  var json_data = JSON.parse(response);
  for (key in json_data) {
    document.getElementById('duedat').value = json_data[key]['newdate'];
  }
}).fail(function() {

});
});
var $select1 = $('#plosu'),
$select2 = $('#tax1'),
$select3 = $('#tax2'),
$select4 = $('#tax3'),
$select5 = $('#tax4'),
$options = $select2.find('option'),
$options1 = $select3.find('option'),
$options2 = $select4.find('option'),
$options3 = $select5.find('option');
if ($options1.value == '{{ cmp1.state }}') {
$options1.text = "{{ cmp1.state }}"
}
$select1.on('change', function() {
if (this.value == "{{ cmp1.state }}") {
  $select2.html($options.filter('[text="' + this.value + '"]'));
  $select3.html($options1.filter('[text="' + this.value + '"]'));
  $select4.html($options2.filter('[text="' + this.value + '"]'));
  $select5.html($options3.filter('[text="' + this.value + '"]'));
} else {
  $select2.html($options.filter('[text="' + " " + '"]'));
  $select3.html($options1.filter('[text="' + " " + '"]'));
  $select4.html($options2.filter('[text="' + " " + '"]'));
  $select5.html($options3.filter('[text="' + " " + '"]'));

}

}).trigger('change');

function insertValue() {
  var select = document.getElementById("select"),
      txtVal = document.getElementById("val").value,
      newOption = document.createElement("OPTION"),
      newOptionval = document.createTextNode(txtVal);

  newOption.appendChild(newOptionval);
  select.insertBefore(newOption, select.lastChild);
}

$('.datepicker').pickadate({
  selectMonths: true,
  selectYears: true
}),
  $('.timepicker').pickatime()

$(function () {
  $('#date-time').bootstrapMaterialDatePicker({
      format: 'YYYY-MM-DD HH:mm'
  });
  $('#date').bootstrapMaterialDatePicker({
      time: false
  });
  $('#time').bootstrapMaterialDatePicker({
      date: false,
      format: 'HH:mm'
  });
});

$(document).ready(function () {

  var current_fs, next_fs, previous_fs; //fieldsets
  var opacity;

  $(".next").click(function () {

      current_fs = $(this).parent();
      next_fs = $(this).parent().next();

//Add Class Active
      $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

//show the next fieldset
      next_fs.show();
//hide the current fieldset with style
      current_fs.animate({opacity: 0}, {
          step: function (now) {
// for making fielset appear animation
              opacity = 1 - now;

              current_fs.css({
                  'display': 'none',
                  'position': 'relative'
              });
              next_fs.css({'opacity': opacity});
          },
          duration: 600
      });
  });

  $(".previous").click(function () {

      current_fs = $(this).parent();
      previous_fs = $(this).parent().prev();

//Remove class active
      $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

//show the previous fieldset
      previous_fs.show();

//hide the current fieldset with style
      current_fs.animate({opacity: 0}, {
          step: function (now) {
// for making fielset appear animation
              opacity = 1 - now;

              current_fs.css({
                  'display': 'none',
                  'position': 'relative'
              });
              previous_fs.css({'opacity': opacity});
          },
          duration: 600
      });
  });

  $('.radio-group .radio').click(function () {
      $(this).parent().find('.radio').removeClass('selected');
      $(this).addClass('selected');
  });

  

});

function ShowHideDiv(track) {
  var inventorytrack = document.getElementById("inventorytrack");

  inventorytrack.style.display = track.checked ? "flex" : "none";

}
function validateForm() {
  let x = document.forms["myForm"]["fname"].value;
  if (x == "") {
    alert("Name must be filled out");
    return false;
  }
}
$(document).ready(function(){

$("#tab_logic").on('click', '.demo', function() {
// get the current row
var currentRow = $(this).closest("tr");

var col1=currentRow.find("td:eq(2)").text();


alert(col1);
});
});



$(document).ready(function(){
$(document).on('click','.demo',function(){
  var first =  document.getElementsByClassName("HSNCODE");

  $('#edithsn').modal('show');

  $('#edithsn1').val(first);
  alert(first)
})
})

    </script>

{% endblock %}